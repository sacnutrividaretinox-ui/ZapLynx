<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WhatsApp Micro-SaaS</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <h2>ZapLynx</h2>
      <ul>
        <li><button onclick="showSection('inicio')">🏠 Início</button></li>
        <li><button onclick="showSection('dashboard')">📊 Dashboard</button></li>
        <li><button onclick="showSection('extrair')">📥 Extrair Contatos</button></li>
        <li><button onclick="showSection('perfil')">📱 Perfil</button></li>
        <li><button onclick="showSection('historico')">📜 Histórico</button></li>
        <li><button onclick="showSection('templates')">📝 Templates</button></li>
      </ul>
    </aside>

    <!-- Conteúdo principal -->
    <main class="content">
      <!-- Início -->
      <section id="inicio" class="active card">
        <h2>Bem-vindo 👋</h2>
        <p>Aqui você encontra vídeos tutoriais e instruções.</p>
      </section>

      <!-- Dashboard -->
      <section id="dashboard" class="card">
        <h2>Dashboard</h2>
        <p>Estatísticas das mensagens enviadas.</p>
      </section>

      <!-- Extrair contatos -->
      <section id="extrair" class="card">
        <h2>Extrair Contatos</h2>
        <p>Funcionalidade para capturar contatos de comunidades.</p>
      </section>

      <!-- Perfil / Conectar Número -->
      <section id="perfil" class="card">
        <h2>Perfil / Conectar Número</h2>
        <button id="btnGerarQr" class="btn-primary">Gerar QR Code</button>
        <div class="qr-container">
          <img id="qrImage" alt="QR Code aparecerá aqui" />
        </div>
      </section>

      <!-- Histórico -->
      <section id="historico" class="card">
        <h2>Histórico</h2>
        <p>Logs de mensagens disparadas, agrupadas por campanhas.</p>
      </section>

      <!-- Templates -->
      <section id="templates" class="card">
        <h2>Templates</h2>
        <p>Modelos de mensagens salvas para reuso.</p>
      </section>
    </main>
  </div>

  <!-- Botão flutuante de suporte -->
  <button id="btnSuporte" class="btn-suporte">💬 Suporte</button>

  <script>
    // Alterna entre seções
    function showSection(id) {
      document.querySelectorAll("main section").forEach(sec => sec.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    // Evento do botão Gerar QR Code
    document.addEventListener("DOMContentLoaded", () => {
      const btn = document.getElementById("btnGerarQr");
      const img = document.getElementById("qrImage");

      if (btn) {
        btn.addEventListener("click", async () => {
          img.src = "";
          img.alt = "Gerando QR Code...";

          try {
            const response = await fetch("/api/qr");
            if (!response.ok) throw new Error("Falha ao buscar QR");

            const blob = await response.blob();
            const url = URL.createObjectURL(blob);
            img.src = url;
            img.alt = "QR Code pronto para escanear";
          } catch (err) {
            console.error("Erro ao carregar QR:", err);
            img.alt = "Erro ao gerar QR Code";
          }
        });
      }
    });
  </script>
</body>
</html>
